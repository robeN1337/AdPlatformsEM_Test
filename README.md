
# Веб-сервис для поиска платформ для заданной локации (Тестовое задание для Effective Mobile)

Веб-сервис позволяет по локации вида `/ru/...` найти подходящие платформы для рекламы из загружаемого `.txt` файла. Хранение данных реализовано в RAM с использованием `List<>` и `Dictionary<>`.


## Запуск проекта

Необходимые пакеты для приложения:

- .NET 8.0 SDK - скачать можно на официальном сайте Microsoft: https://aka.ms/dotnet/download
- Visual Studio 2022 (с нагрузками **ASP.NET** + **Web-разработка**)

Запуск приложения:

  1. Запустите Visual Studio 2022 и в открывшимся окне выберите **Клонирование репозитория**
  2. Вставьте ссылку репозитория и клонируйте его кнопкой **Клонировать** (Clone)
  3. После клонирования Visual Studio должен сам открыть нужное решение, но если этого не произошло - откройте файл решения `Advert_Platforms.sln` в папке склонированного репозитория по следующему пути: `AdPlatformsEM_Test\Advert_Platforms` 
  4. Убедитесь, в выпадающем списке начальных проектов выбран **Advert_Platforms.API** (или в обозревателе решений проект **Advert_Platforms.API** выделен жирным шрифтом.), после чего нажмите зелёную кнопку с надписью **https** для запуска API.
  5. После запуска проекта вас должно перекинуть на Swagger c веб-сервисом автоматически. Если этого не произошло, перейдите по адресу: https://localhost:7236/swagger - после чего браузер редиректнет на Swagger сервисом.
   
    
## Использование API

Для начала нужно загрузить файл со списком площадок и локаций. Файл обязательно должен быть формата `.txt` со следующей **структурой**: \
`<название_площадки1>:<локация1>,<локация2>,...`\
`<название_площадки2>:<локация1>,<локация2>,...`\
`...`

Для загрузки используется метод: **POST** `Location/uploadPlatforms`:

1. В Swagger раскройте метод POST и после чего нажмите **Try it out**
2. Выберите файл с указанной выше структурой и данными и после чего нажмите **Execute** для выполнения запроса и заноса площадок в память. *Ответ* будет содержать список площадок и их локаций.

**Важно**: при попытке выполнить запрос с некорректным файлом (*несоответствующая структура, пустой файл, некорректное расширение*) - мы получим 400 JSON-ответ с подробностями ошибки. Для демонстрации работы в корне репозитория лежит файл `adv_platformslist.txt`, который можно использовать в качестве площадок.

После успешной загрузки площадок можно перейти к поиску подходящих локаций.

Для этого используется метод: **GET** `Location/searchPlatforms`:

1. Раскройте метод GET и после чего нажмите **Try it out**
2. Введите интересующую вас локацию. Например: `/ru`, `/ru/svrd/`
3. Нажмите **Execute**. *Ответ* будет содержать список подходящих площадок.

**Важно**: при попытке выполнить запрос, не загрузив список площадок в методе `Location/uploadPlatforms` - мы получим 400 JSON-ответ с ошибкой.

 

## Тесты

В проекте присутствует тест, который охватывает все методы обновления и поиска данных. Его содержимое можно посмотреть в файле `LocationRepotitoryTest.cs` проекта `Advert_Platforms.Test`

Запуск XUnit теста производится следующим образом:

1. В Visual Studio найти вкладку **Тест**
2. В данной вкладке кликните **Запуск всех тестов**
3. Тест должен пройти успешно.

