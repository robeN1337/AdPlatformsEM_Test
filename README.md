
# Веб-сервис для поиска площадок для заданной локации (Тестовое задание для Effective Mobile)

Веб-сервис позволяет по локации вида `/ru/...` найти подходящие площадки для рекламы из загружаемого `.txt` файла. Хранение данных реализовано в памяти с использованием `List<>` и `Dictionary<>`.


## Запуск проекта

Необходимые пакеты для приложения:

- .NET 8.0 SDK - скачать можно на официальном сайте Microsoft: https://aka.ms/dotnet/download 

Запуск приложения:

  1. Скачайте (или склонируйте через `git clone` если у вас установлена утилита `git`) этот репозиторий через зелёную кнопку `<> Code` -> `Download ZIP` 
  2. Распакуйте архив с папкой в любое удобное для вас место
  3. Перейдите по пути `...\AdPlatformsEM_Test-master\AdPlatformsEM_Test-master\Advert_Platforms` и скопируйте строку поиска в проводнике.
  4. Запустите `cmd` (для Windows) и перейдите по скопированному пути следующим образом: `cd "C:\Users\User\Downloads\AdPlatformsEM_Test-master\AdPlatformsEM_Test-master\Advert_Platforms"` - двойные кавычки обязательны для избежания конфликтов путей.
  5. Соберите проект: 
  ```bash
  dotnet build Advert_Platforms.sln -o build/
  ```
  6. Перейдите в папку собранного проекта командой `cd build/`
  7. Запустите приложение (.dll) командой 
  ```bash
  dotnet Advert_Platforms.API.dll
  ```
  8. Перейдите по адресу: http://localhost:5000/swagger - после чего браузер редиректнет на Swagger с самим сервисом.
   
    
## Использование API

Для начала нужно загрузить файл со списком площадок и локаций. Файл обязательно должен быть формата `.txt` со следующей **структурой**: \
`<название_площадки1>:<локация1>,<локация2>,...`\
`<название_площадки2>:<локация1>,<локация2>,...`\
`...`

Для загрузки используется метод: **POST** `Location/uploadPlatforms`:

1. В Swagger раскройте метод POST и после чего нажмите **Try it out**
2. Выберите файл с указанной выше структурой и данными и после чего нажмите **Execute** для выполнения запроса и заноса площадок в память. *Ответ* будет содержать список площадок и их локаций.

**Важно**: при попытке выполнить запрос с некорректным файлом (*несоответствующая структура, пустой файл, некорректное расширение*) - мы получим 400 JSON-ответ с подробностями ошибки. Для демонстрации работы в корне репозитория лежит файл `adv_platformslist.txt`, который можно использовать в качестве площадок.

После успешной загрузки площадок можно перейти к поиску подходящих локаций.

Для этого используется метод: **GET** `Location/searchPlatforms`:

1. Раскройте метод GET и после чего нажмите **Try it out**
2. Введите интересующую вас локацию. Например: `/ru`, `/ru/svrd/`
3. Нажмите **Execute**. *Ответ* будет содержать список подходящих площадок.

**Важно**: при попытке выполнить запрос, не загрузив список площадок в методе `Location/uploadPlatforms` - мы получим 400 JSON-ответ с ошибкой.

 

## Тесты

В проекте присутствует тест, который охватывает все методы обновления и поиска данных. Его содержимое можно посмотреть в файле `LocationRepotitoryTest.cs` в каталоге `...\AdPlatformsEM_Test-master\AdPlatformsEM_Test-master\Advert_Platforms.Test`.

Запуск XUnit теста производится следующим образом:

1. Нужно собрать проект и перейти в папку `build\`
2. После чего прописать
```bash
dotnet test Advert_Platforms.Test.dll
```
Если тест был завершён успешно, в консоли отобразится зелёная строка со словом **"Пройден!"**

